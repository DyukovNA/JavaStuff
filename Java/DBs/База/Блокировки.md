## Зачем нужны блокировки?

Блокировки в первую очередь нужны для того, чтобы поддерживать консистентность данных в таблице БД. 
Есть два типа блокировок: оптимистическая и пессимистическая. Из названия можно догадаться, что они предлагают две разных стратегии для поддержания целостности данных. Оптимистическая блокировка нацелена на неблокирующий сценарий, а пессимистическая наоборот на блокирующий.

Они обе решают проблему «потерянного изменения» [[Уровни изоляции]]

## Оптимистическая блокировка

Это такой вид блокировки, который не блокирует запись на чтение или изменение, как в пессимистической блокировке. Прежде всего, это подходит тем приложениям, которым промежуточное состояние важно, и они больше читают данные, чем изменяют их.

Не могут вызвать дедлок

Когда два потока хотят изменить одни и те же данные, потоки копируют эти данные в свою локальную память, затем меняют их и пытаются отправить измененные данные в основную память. Перед внесением изменений в основную память проверяется версия данных или предыдущее значение данных. Если проверка не проходит, то поток снова копирует к себе уже новые данные, вносит в них изменения и снова пытается отправить эти измененные данные в основную память.
## Пессимистическая блокировка

Это такой вид блокировки, который лочит запись до тех пор, пока не завершится транзакция. Пока запись удерживается, остальные пользователи ожидают, когда можно будет захватить запись.

Могут вызвать дедлок